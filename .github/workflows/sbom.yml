name: "Generate SBOM"
on:
  push:
    branches: [ main, develop ]
  pull_request:
    types: [ opened, synchronize, reopened ]
jobs:
  generate-sbom:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@master
      - uses: anchore/sbom-action@v0
        with:
          path: ./
          format: cyclonedx-json
          artifact-name: sbom-repo.cdx.json
      - uses: anchore/scan-action@v3
        with:
          sbom: sbom-repo.cdx.json
          fail-build: true
          severity-cutoff: critical
          acs-report-enable: true